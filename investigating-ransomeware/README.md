# Investigating Ransomware with Splunk

## Overview
Conducting investigations is a core component of cybersecurity. When we detect something, it's essential to figure out what happened by asking questions like: who, what, where, when, why, and how. Investigations can be either reactive or proactive, depending on the context.

## Components of Investigation
1. **Incident Response:**
   - Immediate actions taken to address and mitigate an ongoing security incident.
   - Includes containment, eradication, and recovery processes.
   
2. **Threat Hunting:**
   - Proactively searching for signs of malicious activity within an environment.
   - Aims to identify threats that may have evaded traditional security measures.
   
3. **Insider Threat Detection:**
   - Monitoring and detecting suspicious or malicious activities carried out by authorized users within the organization.
   - Helps prevent data breaches and insider attacks.
   
4. **Security Operations:**
   - The ongoing, day-to-day activities related to managing and maintaining security within an organization.
   - Involves monitoring, analyzing, and responding to security alerts and events.

## Data Types Utilized in the Workshop
1. **Microsoft Sysmon:**
   - A Windows system service that logs detailed information about process creations, network connections, and more.
   
2. **Windows Events:**
   - Log files generated by the Windows operating system, containing information about system events and activities.
   
3. **Windows Registry:**
   - A hierarchical database used by the Windows operating system to store configuration settings and options.
   
4. **IIS (Internet Information Services):**
   - A web server software package created by Microsoft.
   - Logs generated by IIS can provide insights into web server activity and potential security issues.
   
5. **Splunk Stream (wire data):**
   - A Splunk component used for capturing, indexing, and analyzing wire data (network traffic).
   - Helps in monitoring network activity and detecting suspicious patterns or anomalies.
   
6. **Suricata:**
   - An open-source intrusion detection and prevention system (IDS/IPS).
   - Provides real-time traffic analysis and alerts on suspicious network activities.
   
7. **Fortigate (NGFW - Next-Generation Firewall):**
   - A firewall appliance developed by Fortinet that incorporates features such as intrusion prevention, antivirus filtering, and application control.
   - Logs generated by Fortigate can provide insights into network traffic and security events.

## Scenario: Investigating Cerber Ransomware Attack at Wayne Enterprises

### Incident Overview:
- **Date and Time:** August 24, 2016
- **Affected Machine:** `we8105desk` 
- **Type of Attack:** Ransomware (Cerber)
- **Impact:** Data encryption, potential data loss, disruption of operations

### 1. Identifying the IP Address of a Victim System
- **Question:** What was the most likely IP address of `we8105desk` on August 24, 2016?
- **Procedure:** Since we are given an identifier of the host and timestamp, we can use this to examine the logs. 

- By searching `"index=botsv1 we8105desk"` and adjusting the specific timestamp to August 24, 2016, we can now access all the data sources related to the incident.
![image_1](https://github.com/michaelsayala/splunk-boss-soc/assets/110712766/c170cedc-84af-4f01-8a9a-583d1d906c7d)

- By clicking the host on the left side fields we can see the top host.
![image2](https://github.com/michaelsayala/splunk-boss-soc/assets/110712766/f5c2408d-9366-474c-a429-a39f5cb70e59)

- By clicking the source on the left side fields we can see the top source.
![image3](https://github.com/michaelsayala/splunk-boss-soc/assets/110712766/e1d0ebd5-9153-498a-be21-2a9becb1fd9f)

- There are a lot of commands to get the same results you want in splunk. For this i will use the top command to get the top 10 by default src_ip by search the query below:
“index=botsv1 we8105desk sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational 
| top src_ip”
![image4](https://github.com/michaelsayala/splunk-boss-soc/assets/110712766/700b56a4-3fb4-41e5-951b-97bf7cff8af9)

Threat Details:
Hostname: we8105desk
IP Address: 192.168.250.100




